## Network setup
Orange Boxes work best when connected to a simple wireless local network (WLAN) with WPA2 or WEP security.

Before the first run, you need to specify the SSID and the password of the network, and a **fixed IP address of the Edge Device computer**. If you don't have a fixed IP for your computer, please set it up now. This can be easily done through your router's configuration page. Usually, you can access it by connecting to the WiFi network and opening the address `192.168.0.1` in your browser. The exact steps depend on the type of your network and router in use.

The Edge Device should have **a single IP address** that is unique within the network. The ZeroMQ protocol on the Edge Device automatically binds to the first address it finds (excluding local addresses such as 127.0.0.1 and 127.0.1.1). Live data streaming will not work if the automatically discovered address differs from the one given to the Orange Box. There are two ways to check the IP address of your computer:
1. Find it on your router's configuration page as explained above.
2. From your computer  
   * (Windows) View [this tutorial](https://support.microsoft.com/en-us/windows/find-your-ip-address-in-windows-f21a9bbc-c582-55cd-35e0-73431160a1b9).
   * (Linux) View [this tutorial](https://opensource.com/article/18/5/how-find-ip-address-linux) and look for ways to determine your **private** (not public) address.

The easiest way to specify network information (SSID, password, fixed IP of the Edge Device) is to put them in a file on a USB stick. This file will be copied during the first run.

1. Create a file called `orange_box.config` on your computer (using Notepad for example). Be careful that it doesn't automatically get renamed to `orange_box.config.txt`. When saving, select the option to save as "all files" rather than just "text file".
1. Copy the contents of [example.config](https://github.com/WatchPlant/OrangeBox/blob/main/config/example.config) to your file.
1. Edit the contents to match your network configuration.
1. Place the file on a USB stick. It's fine to have other files on the stick as well, but make sure the `orange_box.config` is not within a folder.


## First run
When you have completed the Unboxing instructions and Network setup, you are ready for the first run.

1. Place the Orange Box in the range of your WiFi network.
1. Insert the USB stick into one of the three USB ports intended for Blue boxes.
1. Press the power button on the bottom of the panel. You can observe the LED on the Rock Pi computer to determine its current status:
   * GREEN solid, BLUE off - power supply is available,
   * GREEN solid, BLUE flashing - Linux successfully completed the boot process.
1. The system **waits 2 to 5 minutes** to connect to the WiFi network. You don't have to do anything at this time.
1. The status can be determined by the system's LEDs:
   * GREEN solid, BLUE flashing - connecting to WiFi is still in progress,
   * GREEN flashing, BLUE off -  the system is ready to use in online mode,
   * GREEN flashing, BLUE flashing - failed to connect to WiFi, but the system is ready to use in offline mode.  
1. If the Orange Box failed to connect to the WiFi network, it will try again the next time it turns on and you will need to plug in the USB again. If the connection was successful, future start-ups will be shorter.
1. At this point, you can unplug your USB stick and connect the Blue boxes.
1. The Blue boxes should start measuring after a few seconds. If you are using an Edge Device, you should also start receiving data.

If you need to connect to a different WiFi network after the first setup, you will need to delete the file on the Orange Box located at `~/OrangeBox/status/wifi_connect_success.txt`. Detailed instructions are given on the [5. Advanced](5.-Advanced) page.  
The Orange Box will start receiving data from the Blue boxes even if it fails to connect to the WiFi, but data will only be stored locally.

## Edge Device programs
This section explains how to install the necessary programs on the Edge Device computer. The programs come as individual executable files with all dependencies included so installation is not necessary. Currently, packaged executables are available for Windows and Ubuntu.

There are two separate programs:
* **data_sink.exe**: This program runs in the background and acts as a data sink for ZeroMQ messages containing measurement data from all Blue boxes and possibly multiple Orange Boxes. The received data is saved in the `<home>/measurements` folder.
  * On Linux, `<home>` is set to `/home/username`. The full path is then `/home/username/measurements`.
  * On Windows, it is set to `C:\Users\username`. The full path is then `C:\Users\username\measurements`.
* **user_app.exe**: This is a graphical interface to monitor real-time measurement data and enable a basic interaction with the Orange Box. **Important:** data_sink must be running for user_app to function properly, however, data will be saved even if user_app isn't running.

### Installation
Installation is not needed. Simply download the executables from the Release section of this GitHub repository and place them in the folder of your choosing.  
Also, download the `custom_data_fields.yaml` file and save it to the same folder as the executables.

### Running the programs
To run the programs, double-click the executable (in Ubuntu, you may need to mark the files as executable).  
**Important:** Make sure to allow the apps through the firewall.

### Closing the programs
To close the programs, send a Ctrl-C signal to their respective command line interface. Alternatively, just close the command line interface. The first method is preferred.

### Notes
1. The Edge Device **must have a single, known, fixed IP address**.
1. The executables must be packaged on the system they are targeting. Currently, we do not have access to the MacOS platform so we can't make executables for it.
1. The programs run in "background", but real background operation is difficult to program so they actually have to open a command line interface. This may be improved in future versions.
1. We are planning to package both programs as a single executable in the future.